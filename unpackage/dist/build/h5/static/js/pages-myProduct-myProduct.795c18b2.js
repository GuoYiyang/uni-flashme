(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-myProduct-myProduct"],{"06d9":function(t,e,a){"use strict";a.r(e);var n=a("2a3b"),i=a.n(n);for(var u in n)["default"].indexOf(u)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(u);e["default"]=i.a},"2a3b":function(t,e,a){"use strict";a("7a82");var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("c7eb")),u=n(a("1da1")),r=n(a("5530"));a("a9e3"),a("4de4"),a("d3b7"),a("ac1f"),a("14d9"),a("e9c4"),a("a434");var l={props:{value:Array,column:{type:[String,Number],default:2},maxColumn:{type:[String,Number],default:5},columnSpace:{type:[String,Number],default:2},imageKey:{type:[String],default:"image"},hideImageKey:{type:[String],default:"hide"},seat:{type:[String,Number],default:2},listStyle:{type:Object}},data:function(){return{data:{list:this.value?this.value:[],column:this.column<2?2:this.column,columnSpace:this.columnSpace<=5?this.columnSpace:5,imageKey:this.imageKey,seat:this.seat},msg:0,listInitStyle:{"border-radius":"12rpx","margin-bottom":"20rpx","background-color":"#fff"},adds:[],isLoaded:!0,curIndex:0,isRefresh:!0,flag:!1,refreshDatas:[]}},computed:{w:function(){var t="".concat(100/this.data.column-+this.data.columnSpace,"%");return t},m:function(){var t="".concat((100-(100/this.data.column-+this.data.columnSpace).toFixed(5)*this.data.column)/(this.data.column-1),"%");return t},s1:function(){return(0,r.default)((0,r.default)({},this.listInitStyle),this.listStyle)}},created:function(){this.refresh()},methods:{loadImages:function(){for(var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=0,n=this.data.list.filter((function(t,a){return a>=e})),i=0;i<n.length;i++)uni.getImageInfo({src:"".concat(n[i][this.imageKey],".jpg"),complete:function(i){a++,a==n.length&&t.initValue(e)}})},refresh:function(){var t=this;if(!this.isLoaded)return this.refreshDatas=this.value,!1;setTimeout((function(){t.refreshDatas=[],t.isRefresh=!0,t.adds=[],t.data.list=t.value?t.value:[],t.data.column=t.column<2?2:t.column>=t.maxColumn?t.maxColumn:t.column,t.data.columnSpace=t.columnSpace<=5?t.columnSpace:5,t.data.imageKey=t.imageKey,t.data.seat=t.seat,t.curIndex=0;for(var e=1;e<=t.data.column;e++)t.data["column_".concat(e,"_values")]=[],t.msg++;t.$nextTick((function(){t.initValue(t.curIndex,"refresh==>")}))}),1)},columnValue:function(t){return this.data["column_".concat(t+1,"_values")]},change:function(t){for(var e=0;e<this.data.list.length;e++)for(var a=this.data["column_".concat(this.data.list[e].column,"_values")],n=0;n<a.length;n++)if(t[e]&&e===a[n].index){this.data["column_".concat(this.data.list[e].column,"_values")][n]=Object.assign(a[n],t[e]),this.msg++;break}},getMin:function(t,e){for(var a=t[0][e],n=t[0],i=t.length-1;i>=0;i--)t[i][e]<a&&(a=t[i][e]);return n=t.filter((function(t){return t[e]==a})),n[0]},getMinColumnHeight:function(){var t=this;return new Promise((function(e){for(var a=[],n=function(n){var i=uni.createSelectorQuery().in(t);i.select("#waterfalls_flow_column_".concat(n)).boundingClientRect((function(t){a.push({column:n,height:t.height})})).exec((function(){t.data.column<=a.length&&e(t.getMin(a,"height"))}))},i=1;i<=t.data.column;i++)n(i)}))},initValue:function(t,e){var a=this;return(0,u.default)((0,i.default)().mark((function e(){var n,u;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a.isLoaded=!1,!(t>=a.data.list.length||a.refreshDatas.length)){e.next=5;break}return a.msg++,a.loaded(),e.abrupt("return",!1);case 5:return e.next=7,a.getMinColumnHeight();case 7:n=e.sent,u=a.data["column_".concat(n.column,"_values")],a.data.list[t].column=n.column,u.push((0,r.default)((0,r.default)({},a.data.list[t]),{},{cIndex:u.length,index:t,o:0})),a.msg++;case 12:case"end":return e.stop()}}),e)})))()},imgLoad:function(t,e){var a=t.index;t.o=1,this.$set(this.data["column_".concat(e,"_values")],t.cIndex,JSON.parse(JSON.stringify(t))),this.initValue(a+1)},imgError:function(t,e){var a=t.index;t.o=1,t[this.data.imageKey]=null,this.$set(this.data["column_".concat(e,"_values")],t.cIndex,JSON.parse(JSON.stringify(t))),this.initValue(a+1)},loaded:function(){if(this.refreshDatas.length)return this.isLoaded=!0,this.refresh(),!1;this.curIndex=this.data.list.length,this.adds.length?(this.data.list=this.adds[0],this.adds.splice(0,1),this.initValue(this.curIndex)):(this.data.list.length&&this.$emit("loaded"),this.isLoaded=!0,this.isRefresh=!1)},wapperClick:function(t){this.$emit("wapperClick",t)},imageClick:function(t){this.$emit("imageClick",t)}},watch:{value:{deep:!0,handler:function(t,e){var a=this;setTimeout((function(){a.$nextTick((function(){if(a.isRefresh)return!1;if(a.isLoaded){if(t.length<=a.curIndex)return a.change(t);a.data.list=t,a.$nextTick((function(){a.initValue(a.curIndex,"watch==>")}))}else a.adds.push(t)}))}),10)}},column:function(t){this.refresh()}}};e.default=l},"2b1d":function(t,e,a){"use strict";a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.getProductCollect=function(t){return uni.request({url:n.baseUrl+"/product/collect",method:"GET",header:{"X-USER-ID":getApp().globalData.USER_ID},data:{userId:t.userId}})},e.getProductCollectStatus=function(t){return uni.request({url:n.baseUrl+"/product/collect/status",method:"GET",header:{"X-USER-ID":getApp().globalData.USER_ID},data:{userId:t.userId,productId:t.productId}})},e.getProductPage=function(t){var e=null==t.userId?"":t.userId,a=null==t.city?"":t.city,i=null==t.tag?"":t.tag,u=null==t.query?"":t.query;return uni.request({url:n.baseUrl+"/product/page",method:"GET",header:{"X-USER-ID":getApp().globalData.USER_ID},data:{userId:e,city:a,tag:i,query:u,page:t.page,pageSize:t.pageSize}})},e.productCollect=function(t){return uni.request({url:n.baseUrl+"/product/collect",method:"POST",header:{"X-USER-ID":getApp().globalData.USER_ID},data:{userId:t.userId,productId:t.productId,isDelete:t.isDelete}})},e.productDetail=function(t){return uni.request({url:n.baseUrl+"/product/detail",method:"GET",header:{"X-USER-ID":getApp().globalData.USER_ID},data:{id:t.id}})},e.productRandom=function(t){return uni.request({url:n.baseUrl+"/product/random",method:"GET",header:{"X-USER-ID":getApp().globalData.USER_ID},data:{city:t.city,tag:t.tag,query:t.query}})},e.publishProduct=function(t){return uni.request({url:n.baseUrl+"/product/publish",method:"POST",header:{"X-USER-ID":getApp().globalData.USER_ID},data:{userId:t.userId,title:t.title,content:t.content,tags:t.tags,price:t.price,imgUrl:t.imgUrl,imgUrlList:t.imgUrlList}})},e.uploadImages=function(t){return uni.uploadFile({url:n.baseUrl+"/product/image/upload",filePath:t.filePath,name:"file"})};var n=a("0468")},"33ae":function(t,e,a){var n=a("24fb");e=n(!1),e.push([t.i,'@charset "UTF-8";\n/* 水平间距 */\n/* 水平间距 */\n/* uni.scss */.item[data-v-71e9af56]{padding:%?10?% %?10?% %?20?%}.item .title[data-v-71e9af56]{line-height:%?48?%;font-size:%?30?%;color:#222}.item .desc[data-v-71e9af56]{font-size:%?24?%;color:#666}.item .grid-text[data-v-71e9af56]{font-size:14px;color:#909399;padding:%?10?% 0 %?20?% %?0?%;box-sizing:border-box}',""]),t.exports=e},"4a07":function(t,e,a){"use strict";(function(t){a("7a82");var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("99af");var i=n(a("3835")),u=a("2b1d"),r={data:function(){return{page:1,pageSize:10,product:{list:[]}}},methods:{wapperClick:function(t){uni.navigateTo({url:"../product/product?id="+t.id})},imageClick:function(t){uni.navigateTo({url:"../product/product?id="+t.id})}},onLoad:function(e){var a=this;(0,u.getProductPage)({city:"",tag:"",query:"",userId:getApp().globalData.USER_ID,page:this.page,pageSize:this.pageSize}).then((function(e){var n=(0,i.default)(e,2),u=(n[0],n[1]);a.product.list=u.data,t("log",a.product.list," at pages/myProduct/myProduct.vue:63")}))},onReachBottom:function(){var t=this;this.page=this.page+1,(0,u.getProductPage)({userId:getApp().globalData.USER_ID,page:this.page,pageSize:this.pageSize}).then((function(e){var a=(0,i.default)(e,2),n=(a[0],a[1]);n.data.length,t.product.list=t.product.list.concat(n.data)}))}};e.default=r}).call(this,a("0de9")["log"])},"5b05":function(t,e,a){"use strict";var n=a("f6b1"),i=a.n(n);i.a},"87cd":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"waterfalls-flow"},t._l(t.data.column,(function(e,n){return a("v-uni-view",{key:n,staticClass:"waterfalls-flow-column",style:{width:t.w,"margin-left":0==n?0:t.m},attrs:{id:"waterfalls_flow_column_"+(n+1),msg:t.msg}},t._l(t.columnValue(n),(function(e,i){return a("v-uni-view",{key:i,class:["column-value",{"column-value-show":e.o}],style:[t.s1],on:{click:function(a){a.stopPropagation(),arguments[0]=a=t.$handleEvent(a),t.wapperClick(e)}}},[1==t.data.seat?a("v-uni-view",{staticClass:"inner"},[t._t("default",null,null,e)],2):t._e(),a("v-uni-image",{class:["img",{"img-hide":1==e[t.hideImageKey]||1==e[t.hideImageKey]},{"img-error":!e[t.data.imageKey]}],attrs:{src:e[t.data.imageKey],mode:"widthFix"},on:{load:function(a){arguments[0]=a=t.$handleEvent(a),t.imgLoad(e,n+1)},error:function(a){arguments[0]=a=t.$handleEvent(a),t.imgError(e,n+1)},click:function(a){a.stopPropagation(),arguments[0]=a=t.$handleEvent(a),t.imageClick(e)}}}),2==t.data.seat?a("v-uni-view",{staticClass:"inner"},[t._t("default",null,null,e)],2):t._e()],1)})),1)})),1)},i=[]},a310:function(t,e,a){"use strict";a.r(e);var n=a("87cd"),i=a("06d9");for(var u in i)["default"].indexOf(u)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(u);a("fde9");var r=a("f0c5"),l=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"b273d76e",null,!1,n["a"],void 0);e["default"]=l.exports},a837:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return u})),a.d(e,"a",(function(){return n}));var n={customWaterfallsFlow:a("a310").default},i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("v-uni-view",{staticStyle:{padding:"10rpx"}},[a("custom-waterfalls-flow",{ref:"waterfallsFlowRef",attrs:{value:t.product.list,column:2,columnSpace:1.5},on:{imageClick:function(e){arguments[0]=e=t.$handleEvent(e),t.imageClick.apply(void 0,arguments)},wapperClick:function(e){arguments[0]=e=t.$handleEvent(e),t.wapperClick.apply(void 0,arguments)}},scopedSlots:t._u([{key:"default",fn:function(e){return[a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"title"},[t._v(t._s(e.title))]),a("v-uni-view",{staticClass:"title"},[t._v(t._s(e.price))])],1)]}}])})],1)],1)},u=[]},bba6:function(t,e,a){"use strict";a.r(e);var n=a("a837"),i=a("d472");for(var u in i)["default"].indexOf(u)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(u);a("5b05");var r=a("f0c5"),l=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"71e9af56",null,!1,n["a"],void 0);e["default"]=l.exports},bd68:function(t,e,a){var n=a("f81f");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("4f06").default;i("af1fa474",n,!0,{sourceMap:!1,shadowMode:!1})},d472:function(t,e,a){"use strict";a.r(e);var n=a("4a07"),i=a.n(n);for(var u in n)["default"].indexOf(u)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(u);e["default"]=i.a},f6b1:function(t,e,a){var n=a("33ae");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("4f06").default;i("cc04dd06",n,!0,{sourceMap:!1,shadowMode:!1})},f81f:function(t,e,a){var n=a("24fb");e=n(!1),e.push([t.i,'@charset "UTF-8";\n/* 水平间距 */\n/* 水平间距 */\n/* uni.scss */.waterfalls-flow[data-v-b273d76e]{overflow:hidden}.waterfalls-flow-column[data-v-b273d76e]{float:left}.column-value[data-v-b273d76e]{width:100%;font-size:0;overflow:hidden;transition:opacity .4s;opacity:0}.column-value-show[data-v-b273d76e]{opacity:1}.column-value .inner[data-v-b273d76e]{font-size:%?30?%}.column-value .img[data-v-b273d76e]{width:100%}.column-value .img-hide[data-v-b273d76e]{display:none}.column-value .img-error[data-v-b273d76e]{background:#f2f2f2 url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAiAQMAAAAatXkPAAAABlBMVEUAAADMzMzIT8AyAAAAAXRSTlMAQObYZgAAAIZJREFUCNdlzjEKwkAUBNAfEGyCuYBkLyLuxRYW2SKlV1JSeA2tUiZg4YrLjv9PGsHqNTPMSAQuyAJgRDHSyvBPwtZoSJXakeJI9iuRLGDygdl6V0yKDtyMAeMPZySj8yfD+UapvRPj2JOwkyAooSV5IwdDjPdCPspe8LyTl9IKJvDETKKRv6vnlUasgg0fAAAAAElFTkSuQmCC) no-repeat 50%}',""]),t.exports=e},fde9:function(t,e,a){"use strict";var n=a("bd68"),i=a.n(n);i.a}}]);